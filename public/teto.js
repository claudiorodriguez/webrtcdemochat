!function t(e,n,i){function r(s,a){if(!n[s]){if(!e[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(o)return o(s,!0);throw new Error("Cannot find module '"+s+"'")}var u=n[s]={exports:{}};e[s][0].call(u.exports,function(t){var n=e[s][1][t];return r(n?n:t)},u,u.exports,t,e,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(t,e){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(t){return"function"==typeof t}function r(t){return"number"==typeof t}function o(t){return"object"==typeof t&&null!==t}function s(t){return void 0===t}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(t){if(!r(t)||0>t||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},n.prototype.emit=function(t){var e,n,r,a,c,u;if(this._events||(this._events={}),"error"===t&&(!this._events.error||o(this._events.error)&&!this._events.error.length))throw e=arguments[1],e instanceof Error?e:TypeError('Uncaught, unspecified "error" event.');if(n=this._events[t],s(n))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(r=arguments.length,a=new Array(r-1),c=1;r>c;c++)a[c-1]=arguments[c];n.apply(this,a)}else if(o(n)){for(r=arguments.length,a=new Array(r-1),c=1;r>c;c++)a[c-1]=arguments[c];for(u=n.slice(),r=u.length,c=0;r>c;c++)u[c].apply(this,a)}return!0},n.prototype.addListener=function(t,e){var r;if(!i(e))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,i(e.listener)?e.listener:e),this._events[t]?o(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,o(this._events[t])&&!this._events[t].warned){var r;r=s(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,r&&r>0&&this._events[t].length>r&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())}return this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(t,e){function n(){this.removeListener(t,n),r||(r=!0,e.apply(this,arguments))}if(!i(e))throw TypeError("listener must be a function");var r=!1;return n.listener=e,this.on(t,n),this},n.prototype.removeListener=function(t,e){var n,r,s,a;if(!i(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(n=this._events[t],s=n.length,r=-1,n===e||i(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(o(n)){for(a=s;a-->0;)if(n[a]===e||n[a].listener&&n[a].listener===e){r=a;break}if(0>r)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},n.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],i(n))this.removeListener(t,n);else for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},n.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?i(this._events[t])?[this._events[t]]:this._events[t].slice():[]},n.listenerCount=function(t,e){var n;return n=t._events&&t._events[e]?i(t._events[e])?1:t._events[e].length:0}},{}],2:[function(t,e){e.exports="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],3:[function(t,e){function n(){}var i=e.exports={};i.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};if(e){var n=[];return window.addEventListener("message",function(t){var e=t.source;if((e===window||null===e)&&"process-tick"===t.data&&(t.stopPropagation(),n.length>0)){var i=n.shift();i()}},!0),function(t){n.push(t),window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}(),i.title="browser",i.browser=!0,i.env={},i.argv=[],i.on=n,i.addListener=n,i.once=n,i.off=n,i.removeListener=n,i.removeAllListeners=n,i.emit=n,i.binding=function(){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(){throw new Error("process.chdir is not supported")}},{}],4:[function(t,e){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],5:[function(t,e,n){(function(e,i){function r(t,e){var i={seen:[],stylize:s};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),d(e)?i.showHidden=e:e&&n._extend(i,e),x(i.showHidden)&&(i.showHidden=!1),x(i.depth)&&(i.depth=2),x(i.colors)&&(i.colors=!1),x(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=o),c(i,t,i.depth)}function o(t,e){var n=r.styles[e];return n?"["+r.colors[n][0]+"m"+t+"["+r.colors[n][1]+"m":t}function s(t){return t}function a(t){var e={};return t.forEach(function(t){e[t]=!0}),e}function c(t,e,i){if(t.customInspect&&e&&C(e.inspect)&&e.inspect!==n.inspect&&(!e.constructor||e.constructor.prototype!==e)){var r=e.inspect(i,t);return y(r)||(r=c(t,r,i)),r}var o=u(t,e);if(o)return o;var s=Object.keys(e),d=a(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(e)),M(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return l(e);if(0===s.length){if(C(e)){var v=e.name?": "+e.name:"";return t.stylize("[Function"+v+"]","special")}if(b(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(S(e))return t.stylize(Date.prototype.toString.call(e),"date");if(M(e))return l(e)}var _="",m=!1,w=["{","}"];if(g(e)&&(m=!0,w=["[","]"]),C(e)){var x=e.name?": "+e.name:"";_=" [Function"+x+"]"}if(b(e)&&(_=" "+RegExp.prototype.toString.call(e)),S(e)&&(_=" "+Date.prototype.toUTCString.call(e)),M(e)&&(_=" "+l(e)),0===s.length&&(!m||0==e.length))return w[0]+_+w[1];if(0>i)return b(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var P;return P=m?h(t,e,i,d,s):s.map(function(n){return p(t,e,i,d,n,m)}),t.seen.pop(),f(P,_,w)}function u(t,e){if(x(e))return t.stylize("undefined","undefined");if(y(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return m(e)?t.stylize(""+e,"number"):d(e)?t.stylize(""+e,"boolean"):v(e)?t.stylize("null","null"):void 0}function l(t){return"["+Error.prototype.toString.call(t)+"]"}function h(t,e,n,i,r){for(var o=[],s=0,a=e.length;a>s;++s)o.push(j(e,String(s))?p(t,e,n,i,String(s),!0):"");return r.forEach(function(r){r.match(/^\d+$/)||o.push(p(t,e,n,i,r,!0))}),o}function p(t,e,n,i,r,o){var s,a,u;if(u=Object.getOwnPropertyDescriptor(e,r)||{value:e[r]},u.get?a=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(a=t.stylize("[Setter]","special")),j(i,r)||(s="["+r+"]"),a||(t.seen.indexOf(u.value)<0?(a=v(n)?c(t,u.value,null):c(t,u.value,n-1),a.indexOf("\n")>-1&&(a=o?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n"))):a=t.stylize("[Circular]","special")),x(s)){if(o&&r.match(/^\d+$/))return a;s=JSON.stringify(""+r),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function f(t,e,n){var i=0,r=t.reduce(function(t,e){return i++,e.indexOf("\n")>=0&&i++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return r>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function g(t){return Array.isArray(t)}function d(t){return"boolean"==typeof t}function v(t){return null===t}function _(t){return null==t}function m(t){return"number"==typeof t}function y(t){return"string"==typeof t}function w(t){return"symbol"==typeof t}function x(t){return void 0===t}function b(t){return P(t)&&"[object RegExp]"===k(t)}function P(t){return"object"==typeof t&&null!==t}function S(t){return P(t)&&"[object Date]"===k(t)}function M(t){return P(t)&&("[object Error]"===k(t)||t instanceof Error)}function C(t){return"function"==typeof t}function T(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function k(t){return Object.prototype.toString.call(t)}function O(t){return 10>t?"0"+t.toString(10):t.toString(10)}function E(){var t=new Date,e=[O(t.getHours()),O(t.getMinutes()),O(t.getSeconds())].join(":");return[t.getDate(),I[t.getMonth()],e].join(" ")}function j(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var A=/%[sdj%]/g;n.format=function(t){if(!y(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(r(arguments[n]));return e.join(" ")}for(var n=1,i=arguments,o=i.length,s=String(t).replace(A,function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch(e){return"[Circular]"}default:return t}}),a=i[n];o>n;a=i[++n])s+=v(a)||!P(a)?" "+a:" "+r(a);return s},n.deprecate=function(t,r){function o(){if(!s){if(e.throwDeprecation)throw new Error(r);e.traceDeprecation?console.trace(r):console.error(r),s=!0}return t.apply(this,arguments)}if(x(i.process))return function(){return n.deprecate(t,r).apply(this,arguments)};if(e.noDeprecation===!0)return t;var s=!1;return o};var N,L={};n.debuglog=function(t){if(x(N)&&(N=e.env.NODE_DEBUG||""),t=t.toUpperCase(),!L[t])if(new RegExp("\\b"+t+"\\b","i").test(N)){var i=e.pid;L[t]=function(){var e=n.format.apply(n,arguments);console.error("%s %d: %s",t,i,e)}}else L[t]=function(){};return L[t]},n.inspect=r,r.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},r.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=g,n.isBoolean=d,n.isNull=v,n.isNullOrUndefined=_,n.isNumber=m,n.isString=y,n.isSymbol=w,n.isUndefined=x,n.isRegExp=b,n.isObject=P,n.isDate=S,n.isError=M,n.isFunction=C,n.isPrimitive=T,n.isBuffer=t("./support/isBuffer");var I=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",E(),n.format.apply(n,arguments))},n.inherits=t("inherits"),n._extend=function(t,e){if(!e||!P(e))return t;for(var n=Object.keys(e),i=n.length;i--;)t[n[i]]=e[n[i]];return t}}).call(this,t("VCmEsw"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":4,VCmEsw:3,inherits:2}],6:[function(t,e,n){(function(t){(function(){function i(t,e){function n(t){if(n[t]!==v)return n[t];var i;if("bug-string-char-index"==t)i="a"!="a"[0];else if("json"==t)i=n("json-stringify")&&n("json-parse");else{var o,a='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==t){var c=e.stringify,l="function"==typeof c&&y;if(l){(o=function(){return 1}).toJSON=o;try{l="0"===c(0)&&"0"===c(new r)&&'""'==c(new s)&&c(m)===v&&c(v)===v&&c()===v&&"1"===c(o)&&"[1]"==c([o])&&"[null]"==c([v])&&"null"==c(null)&&"[null,null,null]"==c([v,m,null])&&c({a:[o,!0,!1,null,"\x00\b\n\f\r	"]})==a&&"1"===c(null,o)&&"[\n 1,\n 2\n]"==c([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==c(new u(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==c(new u(864e13))&&'"-000001-01-01T00:00:00.000Z"'==c(new u(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==c(new u(-1))}catch(h){l=!1}}i=l}if("json-parse"==t){var p=e.parse;if("function"==typeof p)try{if(0===p("0")&&!p(!1)){o=p(a);var f=5==o.a.length&&1===o.a[0];if(f){try{f=!p('"	"')}catch(h){}if(f)try{f=1!==p("01")}catch(h){}if(f)try{f=1!==p("1.")}catch(h){}}}}catch(h){f=!1}i=f}}return n[t]=!!i}t||(t=a.Object()),e||(e=a.Object());var r=t.Number||a.Number,s=t.String||a.String,c=t.Object||a.Object,u=t.Date||a.Date,l=t.SyntaxError||a.SyntaxError,h=t.TypeError||a.TypeError,p=t.Math||a.Math,f=t.JSON||a.JSON;"object"==typeof f&&f&&(e.stringify=f.stringify,e.parse=f.parse);var g,d,v,_=c.prototype,m=_.toString,y=new u(-0xc782b5b800cec);try{y=-109252==y.getUTCFullYear()&&0===y.getUTCMonth()&&1===y.getUTCDate()&&10==y.getUTCHours()&&37==y.getUTCMinutes()&&6==y.getUTCSeconds()&&708==y.getUTCMilliseconds()}catch(w){}if(!n("json")){var x="[object Function]",b="[object Date]",P="[object Number]",S="[object String]",M="[object Array]",C="[object Boolean]",T=n("bug-string-char-index");if(!y)var k=p.floor,O=[0,31,59,90,120,151,181,212,243,273,304,334],E=function(t,e){return O[e]+365*(t-1970)+k((t-1969+(e=+(e>1)))/4)-k((t-1901+e)/100)+k((t-1601+e)/400)};if((g=_.hasOwnProperty)||(g=function(t){var e,n={};return(n.__proto__=null,n.__proto__={toString:1},n).toString!=m?g=function(t){var e=this.__proto__,n=t in(this.__proto__=null,this);return this.__proto__=e,n}:(e=n.constructor,g=function(t){var n=(this.constructor||e).prototype;return t in this&&!(t in n&&this[t]===n[t])}),n=null,g.call(this,t)}),d=function(t,e){var n,i,r,s=0;(n=function(){this.valueOf=0}).prototype.valueOf=0,i=new n;for(r in i)g.call(i,r)&&s++;return n=i=null,s?d=2==s?function(t,e){var n,i={},r=m.call(t)==x;for(n in t)r&&"prototype"==n||g.call(i,n)||!(i[n]=1)||!g.call(t,n)||e(n)}:function(t,e){var n,i,r=m.call(t)==x;for(n in t)r&&"prototype"==n||!g.call(t,n)||(i="constructor"===n)||e(n);(i||g.call(t,n="constructor"))&&e(n)}:(i=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],d=function(t,e){var n,r,s=m.call(t)==x,a=!s&&"function"!=typeof t.constructor&&o[typeof t.hasOwnProperty]&&t.hasOwnProperty||g;for(n in t)s&&"prototype"==n||!a.call(t,n)||e(n);for(r=i.length;n=i[--r];a.call(t,n)&&e(n));}),d(t,e)},!n("json-stringify")){var j={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},A="000000",N=function(t,e){return(A+(e||0)).slice(-t)},L="\\u00",I=function(t){for(var e='"',n=0,i=t.length,r=!T||i>10,o=r&&(T?t.split(""):t);i>n;n++){var s=t.charCodeAt(n);switch(s){case 8:case 9:case 10:case 12:case 13:case 34:case 92:e+=j[s];break;default:if(32>s){e+=L+N(2,s.toString(16));break}e+=r?o[n]:t.charAt(n)}}return e+'"'},D=function(t,e,n,i,r,o,s){var a,c,u,l,p,f,_,y,w,x,T,O,j,A,L,H;try{a=e[t]}catch(U){}if("object"==typeof a&&a)if(c=m.call(a),c!=b||g.call(a,"toJSON"))"function"==typeof a.toJSON&&(c!=P&&c!=S&&c!=M||g.call(a,"toJSON"))&&(a=a.toJSON(t));else if(a>-1/0&&1/0>a){if(E){for(p=k(a/864e5),u=k(p/365.2425)+1970-1;E(u+1,0)<=p;u++);for(l=k((p-E(u,0))/30.42);E(u,l+1)<=p;l++);p=1+p-E(u,l),f=(a%864e5+864e5)%864e5,_=k(f/36e5)%24,y=k(f/6e4)%60,w=k(f/1e3)%60,x=f%1e3}else u=a.getUTCFullYear(),l=a.getUTCMonth(),p=a.getUTCDate(),_=a.getUTCHours(),y=a.getUTCMinutes(),w=a.getUTCSeconds(),x=a.getUTCMilliseconds();a=(0>=u||u>=1e4?(0>u?"-":"+")+N(6,0>u?-u:u):N(4,u))+"-"+N(2,l+1)+"-"+N(2,p)+"T"+N(2,_)+":"+N(2,y)+":"+N(2,w)+"."+N(3,x)+"Z"}else a=null;if(n&&(a=n.call(e,t,a)),null===a)return"null";if(c=m.call(a),c==C)return""+a;if(c==P)return a>-1/0&&1/0>a?""+a:"null";if(c==S)return I(""+a);if("object"==typeof a){for(A=s.length;A--;)if(s[A]===a)throw h();if(s.push(a),T=[],L=o,o+=r,c==M){for(j=0,A=a.length;A>j;j++)O=D(j,a,n,i,r,o,s),T.push(O===v?"null":O);H=T.length?r?"[\n"+o+T.join(",\n"+o)+"\n"+L+"]":"["+T.join(",")+"]":"[]"}else d(i||a,function(t){var e=D(t,a,n,i,r,o,s);e!==v&&T.push(I(t)+":"+(r?" ":"")+e)}),H=T.length?r?"{\n"+o+T.join(",\n"+o)+"\n"+L+"}":"{"+T.join(",")+"}":"{}";return s.pop(),H}};e.stringify=function(t,e,n){var i,r,s,a;if(o[typeof e]&&e)if((a=m.call(e))==x)r=e;else if(a==M){s={};for(var c,u=0,l=e.length;l>u;c=e[u++],a=m.call(c),(a==S||a==P)&&(s[c]=1));}if(n)if((a=m.call(n))==P){if((n-=n%1)>0)for(i="",n>10&&(n=10);i.length<n;i+=" ");}else a==S&&(i=n.length<=10?n:n.slice(0,10));return D("",(c={},c[""]=t,c),r,s,i,"",[])}}if(!n("json-parse")){var H,U,W=s.fromCharCode,R={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:"\n",102:"\f",114:"\r"},B=function(){throw H=U=null,l()},F=function(){for(var t,e,n,i,r,o=U,s=o.length;s>H;)switch(r=o.charCodeAt(H)){case 9:case 10:case 13:case 32:H++;break;case 123:case 125:case 91:case 93:case 58:case 44:return t=T?o.charAt(H):o[H],H++,t;case 34:for(t="@",H++;s>H;)if(r=o.charCodeAt(H),32>r)B();else if(92==r)switch(r=o.charCodeAt(++H)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:t+=R[r],H++;break;case 117:for(e=++H,n=H+4;n>H;H++)r=o.charCodeAt(H),r>=48&&57>=r||r>=97&&102>=r||r>=65&&70>=r||B();t+=W("0x"+o.slice(e,H));break;default:B()}else{if(34==r)break;for(r=o.charCodeAt(H),e=H;r>=32&&92!=r&&34!=r;)r=o.charCodeAt(++H);t+=o.slice(e,H)}if(34==o.charCodeAt(H))return H++,t;B();default:if(e=H,45==r&&(i=!0,r=o.charCodeAt(++H)),r>=48&&57>=r){for(48==r&&(r=o.charCodeAt(H+1),r>=48&&57>=r)&&B(),i=!1;s>H&&(r=o.charCodeAt(H),r>=48&&57>=r);H++);if(46==o.charCodeAt(H)){for(n=++H;s>n&&(r=o.charCodeAt(n),r>=48&&57>=r);n++);n==H&&B(),H=n}if(r=o.charCodeAt(H),101==r||69==r){for(r=o.charCodeAt(++H),(43==r||45==r)&&H++,n=H;s>n&&(r=o.charCodeAt(n),r>=48&&57>=r);n++);n==H&&B(),H=n}return+o.slice(e,H)}if(i&&B(),"true"==o.slice(H,H+4))return H+=4,!0;if("false"==o.slice(H,H+5))return H+=5,!1;if("null"==o.slice(H,H+4))return H+=4,null;B()}return"$"},J=function(t){var e,n;if("$"==t&&B(),"string"==typeof t){if("@"==(T?t.charAt(0):t[0]))return t.slice(1);if("["==t){for(e=[];t=F(),"]"!=t;n||(n=!0))n&&(","==t?(t=F(),"]"==t&&B()):B()),","==t&&B(),e.push(J(t));return e}if("{"==t){for(e={};t=F(),"}"!=t;n||(n=!0))n&&(","==t?(t=F(),"}"==t&&B()):B()),(","==t||"string"!=typeof t||"@"!=(T?t.charAt(0):t[0])||":"!=F())&&B(),e[t.slice(1)]=J(F());return e}B()}return t},z=function(t,e,n){var i=q(t,e,n);i===v?delete t[e]:t[e]=i},q=function(t,e,n){var i,r=t[e];if("object"==typeof r&&r)if(m.call(r)==M)for(i=r.length;i--;)z(r,i,n);else d(r,function(t){z(r,t,n)});return n.call(t,e,r)};e.parse=function(t,e){var n,i;return H=0,U=""+t,n=J(F()),"$"!=F()&&B(),H=U=null,e&&m.call(e)==x?q((i={},i[""]=n,i),"",e):n}}}return e.runInContext=i,e}var r="function"==typeof define&&define.amd,o={"function":!0,object:!0},s=o[typeof n]&&n&&!n.nodeType&&n,a=o[typeof window]&&window||this,c=s&&o[typeof e]&&e&&!e.nodeType&&"object"==typeof t&&t;if(!c||c.global!==c&&c.window!==c&&c.self!==c||(a=c),s&&!r)i(a,s);else{var u=a.JSON,l=a.JSON3,h=!1,p=i(a,a.JSON3={noConflict:function(){return h||(h=!0,a.JSON=u,a.JSON3=l,u=l=null),p}});a.JSON={parse:p.parse,stringify:p.stringify}}r&&define(function(){return p})}).call(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],7:[function(t,e){function n(t,e){r.call(this,t,e.getBackgroundMatrix()),this._game=e,this._piece=null,this._renderUpdate=!0;var n=this;e.on("hit",function(){n.createBackgroundImage()}),e.on("collapse",function(t){e.pause();var i=n.render,r=0,o=setInterval(function(){r+=60,n._renderUpdate=!0},16),s=n._background;n.render=function(){var e=n._ctx,i=n._canvas.width,o=n._canvas.height;e.clearRect(0,0,i,o),e.putImageData(s,0,0);var a=.3*(Math.cos(.017453292519943295*r+Math.PI)+1)/2+.4;e.fillStyle="rgba(255, 255, 255, "+a+")";for(var c=n._tileHeight,u=0;u<t.length;u++){var l=t[u];e.fillRect(0,l*c,i,c)}},setTimeout(function(){clearInterval(o),n.render=i,n.createBackgroundImage(),n._renderUpdate=!0,e.resume()},200)}),e.on("new-piece",function(){n._renderUpdate=!0}),e.on("move",function(){n._renderUpdate=!0}),e.on("rotate",function(){n._renderUpdate=!0}),e.on("start",function(){n.createBackgroundImage(),n._renderUpdate=!0});var i=function(){n._renderUpdate&&(n._renderUpdate=!1,n.render()),window.requestAnimationFrame(i)};i()}var i=t("util"),r=t("./matrix_renderer");i.inherits(n,r),n.prototype.renderGrid=function(){var t=this._tileWidth,e=this._tileHeight,n=this._canvas.width,i=this._canvas.height,r=n/t,o=i/e,s=this._ctx;s.strokeStyle="rgba(255, 255, 255, 0.07)";for(var a=0;o>a;a++)for(var c=0;r>c;c++)s.beginPath(),s.moveTo(c*t+t+1.5,a*e+1.5),s.lineTo(c*t+t+1.5,a*e+e+1.5),s.stroke(),s.closePath(),s.beginPath(),s.moveTo(c*t+1.5,a*e+e+1.5),s.lineTo(c*t+t+1.5,a*e+e+1.5),s.stroke(),s.closePath()},n.prototype.renderMovingPiece=function(){var t=this._game.getMovingPieceMatrix(),e=this._game.getMovingPiecePosition();if(t)for(var n=(this._tileWidth,this._tileHeight,t.getWidth()),i=t.getHeight(),r=e.x,o=e.y,s=0;i>s;s++)for(var a=0;n>a;a++)this._paintTile(r+a,o+s,t.get(a,s))},n.prototype.createBackgroundImage=function(){var t=this._matrix,e=this._ctx;e.clearRect(0,0,this._canvas.width,this._canvas.height),this.renderGrid();for(var n=t.getWidth(),i=t.getHeight(),r=(this._tileWidth,this._tileHeight,0);i>r;r++)for(var o=0;n>o;o++)this._paintTile(o,r,t.get(o,r));this._background=this._ctx.getImageData(0,0,this._canvas.width,this._canvas.height)},n.prototype.render=function(){var t=this._ctx;this._background&&t.putImageData(this._background,0,0),this.renderMovingPiece()},e.exports=n},{"./matrix_renderer":8,util:5}],8:[function(t,e){function n(t,e,n){this.r=t,this.g=e,this.b=n}function i(t,e,n,i,r,o){o=Math.min(Math.min(o||0,i/2),r/2),t.beginPath();var s=e,a=n;if(0===o)t.moveTo(s,a),t.lineTo(s+i,a),t.lineTo(s+i,a+r),t.lineTo(s,a+r);else{var c=o,u=i-2*c,l=r-2*c;t.moveTo(s+c,a),t.lineTo(s+c+u,a),t.arcTo(s+i,a,s+i,a+c,c),t.lineTo(s+i,a+c+l),t.arcTo(s+i,a+r,s+c+u,a+r,c),t.lineTo(s+c,a+r),t.arcTo(s,a+r,s,a+c+l,c),t.lineTo(s,a+c),t.arcTo(s,a,s+c,a,c)}t.fill(),t.closePath()}function r(t,e){var n=e.x,r=e.y,o=e.width,s=e.height,a=e.colour;t.fillStyle=e.borderColour?e.borderColour.toString():"#000";var c=e.borderRadius||3,u=e.borderWidth||0;i(t,n,r,o+u,s+u,c);var l=t.createLinearGradient(n+u,r+u,n+o,r+s),h=a.lighten(.35),p=a.darken(.35);l.addColorStop(0,h.toString()),l.addColorStop(.48,h.toString()),l.addColorStop(.52,p.toString()),l.addColorStop(1,p.toString()),t.fillStyle=l,i(t,n+u,r+u,o-u,s-u,c),t.fillStyle=a.toString();var f=Math.round(.1*o),g=Math.round(.1*s);i(t,n+f+u,r+g+u,o-2*f-u,s-2*g-u,c)}function o(t,e){this._container=s(t),this._canvas=document.createElement("canvas"),this._canvas.width=this._container.width(),this._canvas.height=this._container.height(),this._container.empty().append(this._canvas),this._ctx=this._canvas.getContext("2d"),this._matrix=e,this._calculatePixelDimensions(),this._createTileImages(),this._tiles=[]}var s=window.jQuery;n.prototype.toString=function(){return"rgb("+[Math.round(this.r),Math.round(this.g),Math.round(this.b)].join(",")+")"},n.prototype.blend=function(t,e){var i=1-e;return new n(this.r*e+t.r*i,this.g*e+t.g*i,this.b*e+t.b*i)},n.prototype.darken=function(t){return this.blend(new n(0,0,0),1-t)},n.prototype.lighten=function(t){return this.blend(new n(255,255,255),1-t)},o.prototype.setMatrix=function(t){this._matrix=t},o.prototype._calculatePixelDimensions=function(){var t=this._matrix;this._tileWidth=Math.round(this._canvas.width/t.getWidth()),this._tileHeight=Math.round(this._canvas.height/t.getHeight())},o.prototype._createTileImages=function(){for(var t=this._ctx,e=[new n(54,179,179),new n(54,54,179),new n(179,134,54),new n(179,179,54),new n(54,179,54),new n(179,54,179),new n(179,54,54)],i=[null],o=this._tileWidth,s=this._tileHeight,a=2,c=0;c<e.length;c++)r(t,{x:0,y:0,width:o,height:s,borderWidth:a,borderRadius:3,colour:e[c]}),i.push(t.getImageData(0,0,o+a,s+a)),t.clearRect(0,0,o+a,s+a);this._tileImages=i},o.prototype._paintTile=function(t,e,n){n>0&&this._ctx.putImageData(this._tileImages[n],t*this._tileWidth,e*this._tileHeight)},o.prototype.render=function(){var t=this._matrix,e=this._ctx;e.clearRect(0,0,this._canvas.width,this._canvas.height);for(var n=t.getWidth(),i=t.getHeight(),r=(this._tileWidth,this._tileHeight,0);i>r;r++)for(var o=0;n>o;o++)this._paintTile(o,r,t.get(o,r))},e.exports=o},{}],9:[function(t,e){function n(t,e){r.call(this,t,e.getBackgroundMatrix()),this._game=e,this._piece=null;var n=this;e.on("hit",function(){n.updateBackground()}),e.on("collapse",function(t){for(var e=0;e<t.length;e++){var i=t[e];$(n.getRowOfTiles(i)).addClass("tile-collapsing")}n.updateBackground()}),e.on("new-piece",function(){n.renderMovingPiece()}),e.on("move",function(){n.updateMovingPiece()}),e.on("rotate",function(){n.rotateMovingPiece()}),e.on("start",function(){n._container.empty(),n.renderBackground(),n.renderMovingPiece()})}var i=t("util"),r=t("./matrix_renderer");i.inherits(n,r),n.prototype.renderBackground=function(){this.render()},n.prototype.updateBackground=function(){this._update()},n.prototype.renderMovingPiece=function(){this._piece&&$(this._piece).remove();var t=this._game.getMovingPieceMatrix(),e=this._game.getMovingPiecePosition(),n=this._tileWidth,i=this._tileHeight,r=document.createElement("div");r.style.position="absolute",r.style.width=t.getWidth()*n+"px",r.style.height=t.getHeight()*i+"px",r.style.left=e.x*n+"px",r.style.top=e.y*i+"px",r.className="piece";for(var o=t.getWidth(),s=t.getHeight(),a=0;s>a;a++)for(var c=0;o>c;c++){var u=this.createTile();u.style.left=c*n+"px",u.style.top=a*i+"px",u.className="tile-"+t.get(c,a),r.appendChild(u)}this._container.append(r),this._piece=r},n.prototype.updateMovingPiece=function(){var t=(this._game.getMovingPieceMatrix(),this._game.getMovingPiecePosition()),e=this._tileWidth,n=this._tileHeight;this._piece.style.left=t.x*e+"px",this._piece.style.top=t.y*n+"px"},n.prototype.rotateMovingPiece=function(){return this.renderMovingPiece()},e.exports=n},{"./matrix_renderer":10,util:5}],10:[function(t,e){function n(t,e){this._container=i(t),this._matrix=e,this._tiles=[],this._tileWidth=0,this._tilHeight=0,this._container.css({position:"relative",overflow:"hidden"}),this._calculatePixelDimensions()}var i=window.jQuery;n.prototype.createTile=function(){var t=document.createElement("div");return t.style.position="absolute",t.style.width=this._tileWidth+"px",t.style.height=this._tileHeight+"px",t},n.prototype._calculatePixelDimensions=function(){var t=this._matrix;this._tileWidth=Math.round(this._container.width()/t.getWidth()),this._tileHeight=Math.round(this._container.height()/t.getHeight())},n.prototype.render=function(){this._container.empty();var t=this._matrix;this._tiles=[];for(var e=t.getWidth(),n=t.getHeight(),i=this._tileWidth,r=this._tileHeight,o=0;n>o;o++)for(var s=0;e>s;s++){var a=this.createTile();a.style.left=s*i+"px",a.style.top=o*r+"px",a.className="tile-"+t.get(s,o),this._container.append(a),this._tiles.push(a)}},n.prototype.getRowOfTiles=function(t){for(var e=this._matrix.getWidth(),n=t*e,i=n+e,r=[],o=n;i>o;o++)r.push(this._tiles[o]);return r},n.prototype._update=function(){for(var t=this._matrix,e=this._tiles,n=e.length,i=0;n>i;i++){var r=t.getAtIndex(i);e[i].className="tile-"+r}},n.prototype.setMatrix=function(t){this._matrix=t},e.exports=n},{}],11:[function(t){function e(){for(var t=new v(10,20),e=["\n1111\n\n","2\n222\n","003\n333\n","0440\n0440\n","055\n55\n","06\n666\n","77\n077\n"],n=0;n<e.length;n++)t.loadPieceMatrix(t.createMatrixFromString(e[n]));return t}function n(t,e){var n=new m(t);return""==e?n.bindKeys({37:{action:"left",delay:100},38:{action:"rotate",delay:200},39:{action:"right",delay:100},40:{action:"down",delay:40},32:{action:"drop",delay:-1}}):window.fakePlayer=n,n}function i(t,e,n){var i=document.createElement("div");g("#game-start"+n).detach().appendTo(i);var r,o=t.button("Play",function(){e.start()});i.appendChild(o),e.once("start",function(){r()}),r=t.show(i)}function r(t,e){var n=document.createElement("div");n.appendChild(t.title("Paused"));var i=null,r=t.button("Resume",function(){i(),i=null});n.appendChild(r);var o=function(){e.isGameover()||i||(i=t.show(n))};g(window).keydown(function(t){80===t.keyCode&&o()}),g(window).blur(function(){})}function o(t,e,n){var i=document.createElement("div");i.appendChild(t.title("Game Over"));var r=document.createElement("table");r.className="scoreboard";var o=document.createElement("thead");o.appendChild(t.tablerow(["high scores"],"th")),r.appendChild(o);var s=document.createElement("tbody");r.appendChild(s),n.on("save",function(){var e=n.getCurrentStats();g(s).empty();var i=n.getBestStats();if(i)for(var r=0;r<i.length;r++){var o=t.tablerow([i[r].score]);i[r].score===e.score&&(o.className="selected"),s.appendChild(o)}}),i.appendChild(r);var a=t.button("New game",function(){e.start()});i.appendChild(a);var c=g.noop;e.on("gameover",function(){c=t.show(i)}),e.on("start",function(){c()})}function s(t,e,s,a,c,u){var h=l(),p=(new h(a,t),new x(t,c,a));i(p,t,u),r(p,t),o(p,t,s);n(t,u)}function a(t,e,n,i){var r=function(){g(e).text(t.getScore()),g(n).text(t.getLines()),g(i).text(t.getLevel())};t.on("update",r),r()}function c(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))}function u(){return c()?b:S}function l(){return c()?P:M}function h(t,n){var i=e(),r=new _(i),o=new y(i,r),c=new w(o,localStorage);return s(i,r,c,g("#game"+n),g("#menu"+n),n),a(o,g("#score"+n),g("#lines"+n),g("#level"+n)),p(i,g("#preview"+n)),C.initSounds(i,{collapses:[g("#collapse1-sound"+n).get(0),g("#collapse2-sound"+n).get(0),g("#collapse3-sound"+n).get(0),g("#collapse4-sound"+n).get(0)]}),i}function p(t,e){var n=u(),i=new n(e,new d(4,4));t.on("set-next-piece",function(t,e){i.setMatrix(f(e,4,4)),i.render()})}function f(t,e,n){var i=Math.max(t.getWidth(),e),r=Math.max(t.getHeight(),n),o=new d(i,r);return o.copy(0,0,t),o}t("./polyfills");var g=window.jQuery,d=t("./matrix"),v=t("./gamestate"),_=t("./player_gamemode"),m=t("./player_controller"),y=t("./score"),w=t("./scoreboard"),x=t("./menu"),b=t("./canvas/matrix_renderer"),P=t("./canvas/game_renderer"),S=t("./dom/matrix_renderer"),M=t("./dom/game_renderer"),C=t("./sound");g(document).ready(function(){g("#game-loading").remove(),g("#game-loading2").remove(),g(".status-container,.game-container").show();h({game:"#game",menu:"#menu",score:"#score",lines:"#lines",level:"#level"},""),h({game:"#game2",menu:"#menu2",score:"#score2",lines:"#lines2",level:"#level2"},"2")})},{"./canvas/game_renderer":7,"./canvas/matrix_renderer":8,"./dom/game_renderer":9,"./dom/matrix_renderer":10,"./gamestate":12,"./matrix":14,"./menu":15,"./player_controller":16,"./player_gamemode":17,"./polyfills":18,"./score":19,"./scoreboard":20,"./sound":21}],12:[function(t,e){function n(t,e){r.call(this),this._background=new o(t,e),this._width=t,this._height=e,this._pieces=[],this._gameover=!0,this._running=!1,this._pauseCount=0,this.clearBackground(),this.clearMovingPiece()}var i=t("util"),r=t("events").EventEmitter,o=t("./matrix");i.inherits(n,r),n.prototype.clearBackground=function(){this._background.clear()},n.prototype.clearMovingPiece=function(){this._movingPieceMatrix=null,this._movingPiecePosition={x:null,y:null}},n.prototype.start=function(){this.clearBackground(),this.clearMovingPiece(),this._nextPiece=null,this._gameover=!1,this._running=!0,this._pauseCount=0,this.emit("start")},n.prototype.isGameover=function(){return this._gameover},n.prototype.isPaused=function(){return!this._running},n.prototype.pause=function(){this._pauseCount+=1,this._running&&!this._gameover&&(this._running=!1,this.emit("pause"))},n.prototype.resume=function(){this._pauseCount-=1,!this._running&&!this._gameover&&this._pauseCount<=0&&(this._running=!0,this.emit("resume"))},n.prototype.loadPieceMatrix=function(t){this._pieces.push(t)},n.prototype.getRandomPieceIndex=function(){return Math.round(99999*Math.random())%this._pieces.length
},n.prototype.setNextPiece=function(t){this._nextPiece=this._pieces[t],this.emit("set-next-piece",t,this._nextPiece)},n.prototype.getStartingPosition=function(t){return{x:Math.floor(this._background.getWidth()/2-t.getWidth()/2),y:0}},n.prototype.loadNextMovingPiece=function(){this._movingPieceMatrix=this._nextPiece,this._movingPiecePosition=this.getStartingPosition(this._movingPieceMatrix),this.hasCollision(0,0)?(this._gameover=!0,this._running=!1,this._movingPieceMatrix=new o(0,0),this.emit("gameover")):this.emit("new-piece")},n.prototype.createMatrixFromString=function(t){var e,n,i;"string"==typeof t?e=t:"array"==typeof t&&(e=t[0],n=t[1],i=t[2]);for(var r=0,s=-1,a=0,c=[],u=0;u<e.length;u++){var l=e[u];if("\n"==l)r=Math.max(r,s),s=-1,a+=1;else{s+=1;var h=parseInt(l,10);h>0&&c.push({x:s,y:a,colour:h})}}r=Math.max(r,s);var p=new o(r+1,a+1,n,i);for(u=0;u<c.length;u++){var f=c[u];p.set(f.x,f.y,f.colour)}return p},n.prototype.getBackgroundMatrix=function(){return this._background},n.prototype.getMovingPieceMatrix=function(){return this._movingPieceMatrix},n.prototype.getMovingPiecePosition=function(){return this._movingPiecePosition},n.prototype.hasCollision=function(t,e){return this._background.collision(this._movingPiecePosition.x+t,this._movingPiecePosition.y+e,this._movingPieceMatrix)},n.prototype.collapse=function(t,e){for(var n=[],i=(this._width,e),r=e;i>=t;i--,r--)this._background.isRowFilled(i)&&(n.push(r),this._background.collapseRow(i),i=e+1,r=i-n.length);n.length>0&&this.emit("collapse",n)},n.prototype.stopMovingPiece=function(){this._background.copy(this._movingPiecePosition.x,this._movingPiecePosition.y,this._movingPieceMatrix),this.emit("hit"),this.collapse(0,this._background.getHeight()-1)},n.prototype.getCompositeMatrix=function(){var t=this._background.getWidth(),e=this._background.getHeight(),n=new o(t,e);return n.copy(0,0,this._background),n.copy(this._movingPiecePosition.x,this._movingPiecePosition.y,this._movingPieceMatrix),n},n.prototype.move=function(t,e){this._running&&(this.hasCollision(t,e)?e>0&&this.stopMovingPiece():(this._movingPiecePosition.x+=t,this._movingPiecePosition.y+=e,this.emit("move",t,e)))},n.prototype._applyRotate=function(t,e,n){var i=this._background.collision(e,n,t);return i?!1:(this._movingPiecePosition.x=e,this._movingPiecePosition.y=n,this._movingPieceMatrix=t,this.emit("rotate"),!0)},n.prototype.rotate=function(){if(this._running){var t=this._movingPieceMatrix.rotate(),e=this._movingPiecePosition.x,n=this._movingPiecePosition.y;if(!this._applyRotate(t,e,n)){var i=e,r=this._background,o=this._movingPieceMatrix,s=i+t.getWidth();for(e=i;s>e&&!r.collision(e,n,o);e++)if(this._applyRotate(t,e,n))return;var a=i-t.getWidth();for(e=i;e>a&&!r.collision(e,n,o);e--)if(this._applyRotate(t,e,n))return}}},e.exports=n},{"./matrix":14,events:1,util:5}],13:[function(t,e){function n(t){var e={},n=function(e){var n=t(e);i(n,e)},i=function(t,i){var r=e[i.which];if(t>=0){var o=setTimeout(function(){n(r.event)},t);r.timeout=o}else r.timeout=null},o=function(t){var i=e[t.which];i?(null===i.timeout&&n(t),i.isDefaultPrevented&&t.preventDefault()):(e[t.which]={timeout:null,isDefaultPrevented:!1,event:{which:t.which,preventDefault:function(){},isDefaultPrevented:function(){return!1}}},n(t),e[t.which].isDefaultPrevented=t.isDefaultPrevented())},s=function(t){var n=e[t.which];n&&(clearTimeout(n.timeout),delete e[t.which])};r(document).keydown(o),r(document).keyup(s);var a=function(){r(document).unbind("keydown",o),r(document).unbind("keyup",s);for(var t in e)clearTimeout(e[t].timeout)};return a}function i(t){return n(function(e){var n=t[e.which];return n?(e.preventDefault(),n.action(),n.delay):void 0})}var r=window.jQuery;e.exports={bindKeys:i}},{}],14:[function(t,e){function n(t,e,n,i){this._width=t,this._height=e,this._originX=void 0!==n?n:t/2,this._originY=void 0!==i?i:e/2,this._matrix=[],this.clear()}n.prototype.clear=function(){for(var t=this._width*this._height,e=0;t>e;e++)this._matrix[e]=0},n.prototype.getWidth=function(){return this._width},n.prototype.getHeight=function(){return this._height},n.prototype.getOriginX=function(){return this._originX},n.prototype.getOriginY=function(){return this._originY},n.prototype.index=function(t,e){return e*this._width+t},n.prototype.get=function(t,e){return this._matrix[this.index(t,e)]},n.prototype.getAtIndex=function(t){return this._matrix[t]},n.prototype.isOpaque=function(t){return t>0},n.prototype.set=function(t,e,n){this._matrix[this.index(t,e)]=n},n.prototype.isRowFilled=function(t){for(var e=this.index(0,t),n=e+this._width,i=e;n>i;i++)if(!this.isOpaque(this._matrix[i]))return!1;return!0},n.prototype.collapseRow=function(t){var e=this._width,n=this.index(this._width-1,t),i=n-e;if(t>0)for(;i>=0;i--,n--)this._matrix[n]=this._matrix[i];for(var r=0;e>r;r++)this._matrix[r]=0},n.prototype.rotate=function(){var t=this._width,e=this._height,i=this._originX,r=this._originY,o=new n(t,e,i,r);return this.forEachOpaque(function(t,e,n){var s=-(e-r)+i-1,a=t-i+r;return o.set(Math.floor(s),Math.floor(a),n),!0}),o},n.prototype.forEachOpaque=function(t){for(var e=this._width,n=this._matrix,i=e*this._height,r=-1,o=-1,s=0;i>s;s++){s%e==0?(r=0,o+=1):r+=1;var a=n[s];if(this.isOpaque(a)&&!t(r,o,a))return}},n.prototype.collision=function(t,e,n){var i=!1,r=this,o=this._width,s=this._height;return n.forEachOpaque(function(n,a){var c=t+n,u=e+a;return i=u>=s||0>c||c>=o||r.isOpaque(r.get(c,u)),!i}),i},n.prototype.copy=function(t,e,n){var i=this;n.forEachOpaque(function(n,r,o){return i.set(t+n,e+r,o),!0})},e.exports=n},{}],15:[function(t,e){function n(t,e,n){this._game=t,this._foreground=i(e),this._background=i(n),this._dialogs=[]}var i=window.jQuery;n.prototype.show=function(t){var e=this._dialogs.length;this._dialogs.push(t),0===e&&(this._background.css({"-webkit-filter":"blur(2px) grayscale(100%)"}),this._game.pause()),this._showElement(t);var n=this;return function(){n.hide(e)}},n.prototype._showElement=function(t,e){var n=this._foreground;n.fadeOut(200,function(){n.empty(),t?n.append(t).fadeIn(200,e):e&&e()})},n.prototype.getVisibleIndex=function(){for(var t=this._dialogs.length-1;t>=0;t--){if(null!==this._dialogs[t])return t;this._dialogs.pop()}return-1},n.prototype.hide=function(t){if(void 0===t&&(t=this._dialogs.length-1),!(t>=this._dialogs.length)){var e=this.getVisibleIndex();if(this._dialogs[t]=null,t===e){var n,i=this.getVisibleIndex();-1===i?(this._dialogs=[],n=null):n=this._dialogs[i];var r=this;this._showElement(n,function(){0===r._dialogs.length&&(r._background.css({"-webkit-filter":"none"}),r._game.resume())})}}},n.prototype.title=function(t){var e=document.createElement("h1");return e.appendChild(document.createTextNode(t)),e},n.prototype.button=function(t,e){var n=i('<button type="button" class="btn"></button>');return n.text(t),e&&(n.get(0).onclick=e),n.get(0)},n.prototype.tablerow=function(t,e){e=e||"td";for(var n=document.createElement("tr"),i=0;i<t.length;i++){var r=document.createElement(e),o=t[i];switch(typeof o){case"string":case"number":o=document.createTextNode(o);break;case"function":o=o()}r.appendChild(o),n.appendChild(r)}return n},e.exports=n},{}],16:[function(t,e){function n(t){this._game=t,this._uninstallBindings=null,this._dropping=!1}var i=t("./input");n.prototype.move=function(t,e){this._dropping||this._game.move(t,e)},n.prototype.rotate=function(){this._dropping||this._game.rotate()},n.prototype.drop=function(){if(!(this._dropping||this._game.isPaused()||this._game.isGameover())){this._dropping=!0;var t=this;this._droppingInterval=setInterval(function(){t._game.move(0,1)},10),this._game.once("hit",function(){clearInterval(t._droppingInterval),t._dropping=!1})}},n.prototype.togglePause=function(){this._game.isPaused()?this._game.resume():this._game.pause()},n.prototype.bindKeys=function(t){var e={},n={left:this.move.bind(this,-1,0),right:this.move.bind(this,1,0),down:this.move.bind(this,0,1),rotate:this.rotate.bind(this),drop:this.drop.bind(this),togglePause:this.togglePause.bind(this)};for(var r in t)e[r]={action:n[t[r].action],delay:t[r].delay};this._uninstallBindings&&this._uninstallBindings(),this._uninstallBindings=i.bindKeys(e)},e.exports=n},{"./input":13}],17:[function(t,e){function n(t){this._game=t,this._timer=null,this._lines=0,this._level=1;var e=this;t.on("hit",function(){e._loadMovingPiece()}),t.on("start",function(){e.start()}),t.on("gameover",function(){e._stopTimer()}),t.on("collapse",function(t){e._lines+=t.length,e._level=Math.floor(Math.min(e._lines,200)/20)+1})}n.prototype.getLevel=function(){return this._level},n.prototype._setNextPiece=function(){this._game.setNextPiece(this._game.getRandomPieceIndex())},n.prototype._loadMovingPiece=function(){this._game.loadNextMovingPiece(),this._setNextPiece()},n.prototype.update=function(){this._game.move(0,1)},n.prototype._startTimer=function(){if(!this._timer){var t=this,e=function(){n(),t.update()},n=function(){t._timer=setTimeout(e,65*(10-t._level)+50)};n()}},n.prototype._stopTimer=function(){this._timer&&(clearTimeout(this._timer),this._timer=null)},n.prototype.start=function(){this._level=1,this._lines=0,this._setNextPiece(),this._loadMovingPiece(),this._startTimer()},e.exports=n},{}],18:[function(t){window.JSON=t("json3"),Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),n=this,i=function(){},r=function(){return n.apply(this instanceof i&&t?this:t,e.concat(Array.prototype.slice.call(arguments)))};return i.prototype=this.prototype,r.prototype=new i,r}),function(){for(var t=0,e=["webkit","moz"],n=0;n<e.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[e[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[n]+"CancelAnimationFrame"]||window[e[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var n=(new Date).getTime(),i=Math.max(0,16-(n-t)),r=window.setTimeout(function(){e(n+i)},i);return t=n+i,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}()},{json3:6}],19:[function(t,e){function n(t,e){r.call(this),this._game=t,this._gameMode=e,this._lines=0,this._score=0,this._dropScore=0,this.initNormalScoring()}var i=t("util"),r=t("events").EventEmitter;i.inherits(n,r),n.prototype.initNormalScoring=function(){var t=this;this._game.on("start",function(){t._lines=0,t._score=0,t.emit("update",0)});var e=[40,100,300,1200];this._game.on("collapse",function(n){var i=n.length;t._lines+=i,t.add(e[i-1]*t._gameMode.getLevel())}),this._game.on("rotate",function(){t._dropScore=0}),this._game.on("move",function(e,n){n>0&&0==e?t._dropScore+=n:0!==e&&(t._dropScore=0)}),this._game.on("hit",function(){t.add(t._dropScore),t._dropScore=0}),this._game.on("gameover",function(){t.emit("final",t.getStats())})},n.prototype.getStats=function(){return{score:this._score,lines:this._lines,level:this._gameMode.getLevel()}},n.prototype.add=function(t){0!==t&&(this._score+=t,this.emit("update",t))},n.prototype.getLines=function(){return this._lines},n.prototype.getScore=function(){return this._score},n.prototype.getLevel=function(){return this._gameMode.getLevel()},e.exports=n},{events:1,util:5}],20:[function(t,e){function n(t,e){this._scoring=t,this._storage=e,this._bestStats=[],this._load();var n=this;t.on("final",function(t){ga&&(ga("send","event","game","gameover","score",t.score),ga("send","event","game","gameover","lines",t.lines),ga("send","event","game","gameover","level",t.level)),n._insertStats(t),n._save()})}var i=t("util"),r=t("events").EventEmitter;i.inherits(n,r),n.prototype.getCurrentStats=function(){return this._scoring.getStats()},n.prototype.getBestStats=function(){return this._bestStats},n.prototype._load=function(){var t=JSON.parse(this._storage.getItem("bestStats"));t&&t.length&&(this._bestStats=t)},n.prototype._save=function(){this._storage.setItem("bestStats",JSON.stringify(this._bestStats)),this.emit("save")},n.prototype._insertStats=function(t){this._bestStats.push(t),this._bestStats.sort(function(t,e){return t.score>e.score?-1:t.score<e.score?1:0});var e=3;this._bestStats.length>e&&(this._bestStats=this._bestStats.slice(0,e))},e.exports=n},{events:1,util:5}],21:[function(t,e){function n(t,e){if(window.Audio){var n=function(t,e){setTimeout(function(){t.currentTime=0,t.play()},e)};t.on("collapse",function(t){for(var i=0;i<t.length;i++){var r=e.collapses[i];r&&n(r,150*i)}})}}e.exports={initSounds:n}},{}]},{},[11]);